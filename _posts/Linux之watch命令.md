---
title: Linux之watch命令
date: 2023-08-21 14:11:33
tags:
	- Linux

---

--

# watch命令

`watch` 命令用于周期性地执行并显示指定的命令的输出，以便你可以实时监视命令的执行结果。它在终端中非常有用，特别是当你希望持续观察某个命令的输出变化时。下面是 `watch` 命令的基本用法：

```bash
watch [选项] 命令
```

- `选项`：用于配置 `watch` 命令的选项，下面将介绍一些常用选项。
- `命令`：要执行和监视的命令。

下面是一些常用的 `watch` 命令选项：

- `-n` 或 `--interval`：指定监视周期的时间间隔，以秒为单位。例如，`-n 5` 将每隔 5 秒执行一次命令并显示结果。
- `-d` 或 `--differences`：高亮显示当前输出与上一次输出之间的不同之处。
- `-t` 或 `--no-title`：不显示标题行，只显示命令的输出。
- `-b` 或 `--beep`：在输出发生变化时发出响铃提示。
- `-c` 或 `--color`：使用彩色输出。

例如，如果要每隔 2 秒查看系统中运行的进程数变化，可以使用以下命令：

```bash
watch -n 2 "ps aux | wc -l"
```

这将每隔 2 秒运行一次 `ps aux | wc -l` 命令，并显示进程数的变化。

要停止 `watch` 命令，可以按下 `Ctrl + C`。请注意，`watch` 命令的输出窗口默认情况下是无限滚动的，你可以通过按下 `q` 键来退出 `watch` 模式。

`watch` 命令对于监视日志文件、查看实时系统资源使用情况、跟踪文件或目录变化等情况非常有用。

# 典型使用场景

`watch` 命令在监视和实时跟踪各种系统和命令的输出时非常有用。以下是一些 `watch` 命令的典型使用场景的举例：

1. **监视系统资源使用情况**：查看系统的实时资源利用率，如 CPU 使用率、内存使用情况和磁盘空间。例如，监视内存使用情况：

    ```bash
    watch -n 2 free -m
    ```

2. **跟踪日志文件变化**：在实时监视日志文件的变化时，`watch` 可以帮助你查看新的日志条目。例如，查看 `/var/log/syslog` 文件的最新日志：

    ```bash
    watch -n 2 tail /var/log/syslog
    ```

3. **监视网络连接**：查看系统上的网络连接，以便了解哪些应用程序正在使用网络。例如，监视当前的网络连接：

    ```bash
    watch -n 2 netstat -tuln
    ```

4. **监视进程**：跟踪运行的进程数、CPU 占用率和内存占用情况。例如，监视进程数：

    ```bash
    watch -n 2 "ps aux | wc -l"
    ```

5. **查看磁盘空间**：实时查看磁盘使用情况以确保不会耗尽磁盘空间。例如，监视 `/var` 目录的磁盘使用情况：

    ```bash
    watch -n 2 df -h /var
    ```

6. **监视系统日志**：实时查看系统日志以查找可能的错误或警告消息。例如，监视 `/var/log/messages` 文件：

    ```bash
    watch -n 2 cat /var/log/messages
    ```

7. **监视自定义脚本或命令**：你可以使用 `watch` 来定期运行自己编写的脚本或命令，以检查自定义应用程序的状态或数据。

这些场景只是 `watch` 命令的一些典型用法示例。通过 `watch` 命令，你可以实时查看各种系统和命令的输出，有助于故障排除、性能分析和监控系统状态。

