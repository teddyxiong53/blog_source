---
title: 字符编码了解
date: 2017-10-09 22:18:28
tags:
	- 编码
---

--

1、编码的起源就是ASCII码。ASCII码只用了一个字节的低7位。

2、随着计算机的发展，很快就发现了问题，ASCII码表示不了欧洲的某些字母文字。不是还有128到255这些当前没有用嘛。拿过来用。对于欧洲的字母，也勉强可以塞进去了。

这个时候就得到了扩展字符集。

3、等计算机传到中国来的时候，发现没法表示中文了。我们就想了个办法，把128到255的这些欧洲字母，我们不用。而且我们做了一个规定，如果一个字节的值小于127，那么含义还是表示对于的ASCII字符，当连续2个字符都大于127的时候，我们就说，这2个字节表示一个汉字。前一个字节的范围是0xA1到0xF7，后面一个字节的范围是0xA1到0xFE。这么一组合，我们可以塞进去7000个左右的汉字。我们常用汉字没这么多，我们还一起把希腊字母、日文等东西也塞进去了。还有一些全角标点，也塞在这里。我们把这一套叫做GB2312。这个一个对ASCII的中文扩展。

4、但是，很快我们就发现了新的问题，上面的方案可以塞进去的汉字不多。麻烦的是，国家领导人的名字都没包含进去。我们就把上面还有些没用占用的位置也找出来用。还是不够。我们就干脆改了上面的规定，只要第一个是大于127的就表示汉字了，后面一个的范围不要求大于127，这样把范围又扩大了。我们把这个方案叫做GBK方案。GBK兼容了GB2312，增加了大概2万个汉字的容量。再后来，我们又增加了一些少数民族的文字进去，就得到了GB18030的方案。这个方案叫做双字节字符集。我们把自己的事情终于搞定了。

5、当时，不只是中国这么干，其他国家也干了类似的事情，而且大家相互不兼容。容易导致乱码。

6、国际标准化组织终于出手了。他们的方案简单粗暴，废除所有的地区性的编码方案，重新搞一套可以包含地球上所有文字的编码。这就是Unicode。

开始搞Unicode的时候，计算机已经不缺空间了。于是ISO就规定必须用2个字节来表示字符。ASCII的那些字符，还是放在最前面，数值和单个字节的是相等的，但是还是要占用2个字节的空间。这个方案导致了空间的浪费。

Unicode在很长一段时间里没法推广开来，知道互联网的出现，为了解决Unicode在网络上的传输的问题，各种UTF开始出来了。UTF表示Transfer Format。UTF-8表示每次8个bit传输，UTF-16就是每次16bit。

UTF-8是一种使用最高分的Unicode编码形式。

UTF-8的最大特点就是，它是一种边长的编码。它的长度是1个4个字节不等。

从Unicode到UTF-8是要经常算法来转换的。

Unicode是字符集。UTF-8是编码规则。

字符集是给每一个字符分配了一个ID。



看了阮一峰的博客。感觉有些明白了。



UTF-8方式，一个汉字是3个字节。

之所以是3个字节，因为2个不够，3个够了。Unicode是4个字节？不是，是6个字节。



怎么查一个汉字的Unicode？



一个“严”字为例。

http://tool.chinaz.com/tools/unicode.aspx

```
Unicode编码是：\u4e25
utf-8编码是：&#x4E25;
url编码是：%e4%b8%a5
```



看看文件保存的情况。

用notepad++新建一个文件encode.txt文件。

输入一个“严”字。保存。

npp默认是用utf-8保存的。

用vscode的hexdump查看文件。里面是：

```
E4 B8 A5
```

我们在npp里勾选为gb2312编码，重新输入“严”字。保存。看vscode里。

```
D1 CF
```

使用utf-8 bom编码，会多3个字节在前面。

```
EF BB BF E4 B8 A5
```

bom是byte order mark的缩写。

这里有说明。

https://en.wikipedia.org/wiki/Byte_order_mark

一般不用，至少网络上不用。但是bom是Unicode标准里的。

尤其在unix环境，大家都不欢迎bom的。

bom这个东西违反了Unix的原则，就是文档里存在的数据必须可见。

首先就是脚本文件开头的

```
#!/bin/sh
```

跟这个冲突。

继续看“严”字的其他编码。

使用UCS2 big endian编码。是这样。

```
FE FF 4E 25
```

使用UCS2 little endian编码。

```
FF FE 25 4E
```



参考资料

1、

http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html

2、unicode编码是占用几个字节？

https://segmentfault.com/q/1010000009652523

3、java的中文到底占几个字节？

https://segmentfault.com/q/1010000003757947

4、Unicode和UTF-8

https://akaedu.github.io/book/apas02.html

5、查询任意汉字的Unicode编码,UTF8编码,GB2312编码,GBK编码

https://zhuanlan.zhihu.com/p/30945662

6、「带 BOM 的 UTF-8」和「无 BOM 的 UTF-8」有什么区别？网页代码一般使用哪个？

https://www.zhihu.com/question/20167122