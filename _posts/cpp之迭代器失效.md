---
title: cpp之迭代器失效
date: 2019-03-20 17:07:32
tags:
	- cpp

---

1

**迭代器是一种**检查容器内部元素并遍历元素的**数据类型**。

c++更推荐使用迭代器，而不是用下标进行操作。

因为每一种容器都支持迭代器，只有少数容器支持下标操作。



可以简单理解，迭代器就是指针。



看muduo的相关博客，看到这句话：

```
这两个 indices 的类型是 int，不是 char*，目的是应对迭代器失效。
```

迭代器失效具体代表了什么？



讨论迭代器失效之前，我们先看看什么是迭代器。

```
1、迭代器是连接容器和算法的纽带。
2、为数据提供了抽象。这样写算法的人就不用关心数据结构的细节。
3、迭代器提供了数据访问的标准模型：对象序列。

迭代器是一种广义的指针。
是指向序列元素指针概念的一种抽象。
```



泛型编程的关键所在，就是如何找到一种通用的方法，来访问具有不同结构的各种容器中的每个元素。



```
容器是数组的抽象。
迭代器是指向数字的指针的抽象。
```



在STL里，为每种容器typedef了一个迭代器。

例如：

```
std::vector<T>::iterator
```



#迭代器的基本特性

```
1、解除引用。
	就是类似指针取值一样。
2、赋值。
3、比较。
4、遍历。
```

#迭代器的操作

```
1、读。
2、写。
3、访问。
4、迭代。
5、比较。
```

不同的泛型算法，对迭代器的要求也不同。

例如，查找算法，只要求迭代器定义++操作符，这样就可以遍历整个容器。

查找算法，并不需要修改数据，所以不需要写操作。



#迭代器的分类

根据迭代器所支持的操作不同，在STL里定义了5种迭代器。

```
1、输入迭代器。
2、输出迭代器。
3、前向迭代器。
4、双向迭代器。
5、随机访问迭代器。
```



# 迭代器失效

向容器里添加或者删除元素都可能会使得指向容器元素的迭代器失效。

为什么迭代器会失效？

以vector为例，当我们插入一个元素时，它的预分频空间可能不够了。它会重新申请一段内存。把之前的元素复制到新的空间上去。

之前的迭代器，就是一个指针嘛，指针指向的位置已经无效了。





参考资料

1、STL中迭代器失效详解

https://blog.csdn.net/skyroben/article/details/70877008

2、C++学习篇——C++ STL中迭代器介绍

https://blog.csdn.net/chenjiayi_yun/article/details/25844205

3、C++ 迭代器失效

https://blog.csdn.net/zhongjiekangping/article/details/5624922