---
title: 渗透之openwrt
date: 2020-09-24 16:42:30
tags:
	- 渗透

---

1

不过由于物联网设备本身就是嵌入式的，想要直接在设备上抓包几乎是不可能的。那么怎么办呢？最简单最全面的办法，就是在接入端，也就是路由器侧抓取和分析网络流量。

一般的路由器，想要抓包还是挺麻烦的。不过所幸我是自己刷的 *OpenWrt* ，作为一款支持 *Linux* 的嵌入式系统，可以直接安装 *Tcpdump* ，抓包的问题就迎刃而解。

安装好 *Tcpdump* 后，就可以直接运行起来开始抓包了。不过这里又有一个问题了，路由器本身也是一个嵌入式设备，本身内存优先就限制了抓包的量不能太大。另外抓下来的包，在路由器上也不好分析。说到分析网络流量包，我想大多数人都听说过甚至喜欢 *Wireshark* 。那么，有没有办法使用 *Wireshark* 来分析 *OpenWrt* 抓取的流量呢？



```
ssh root@192.168.1.10 'tcpdump  -s 0 -U -n -w - -i br-lan host 192.168.0.104' | wireshark -k -i -
```

192.168.1.10是路由器的地址

192.168.1.104 是手机的地址。

其中， *Tcpdump* 的几个参数说明如下：

- `-s 0` : 表示抓包大小，设置为 `0` 表示不限制。
- `-n` : 不解析IP地址为主机名（以及不解析端口为端口名）
- `-w -` : 表示抓取到的包输出到标准输出
- `-i br-lan` : 表示抓取 `br-lan` 接口上的包。路由器上通常都是这个网络接口。

关于 *Wireshark* 的参数说明如下：

- `-k` : 表示启动wireshark后立即开始抓包
- `-i -` : 表述从标准输入获取数据



但是这个实际上抓不到。



参考资料

1、使用Wireshark完成OpenWrt抓包

https://www.atfeng.com/post/%E4%BD%BF%E7%94%A8wireshark%E5%AE%8C%E6%88%90openwrt%E6%8A%93%E5%8C%85/