---
title: 网络之tcp的timewait问题
date: 2018-09-14 10:47:27
tags:
	- 网络

---



我杀掉进程再重新启动，导致了网络连接出现问题。

查看netstat，发现端口处于TIME WAIT状态。

这种还是要靠REUSEADDR来避免问题。



主动关闭tcp连接的一方，最后的状态就是time wait。

原因：

1、为了实现tcp全双工连接的可靠释放。

主动关闭的一方，在time wait状态会保持2MSL，大概是1分钟。

假设主动关闭的一方，最后的ACK丢失了。因为tcp的重传机制，被动关闭的一方，要重传FIN。

为了保证这个FIN可以收到。

如果没有这个time wait状态。你重新启动程序，这个时候，被动关闭的一方发来了一个重传的FIN。

主动这边因为是新连接了，会直接RST连接的。这个也是不好的。

2、除了上面的原因，还有一个原因，就是为了使旧的网络包在网络中因为过期而消失。



# 参考资料

1、面试总结之time_wait状态产生的原因，危害，如何避免

https://blog.csdn.net/u013616945/article/details/77510925