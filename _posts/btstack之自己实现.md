---
title: btstack之自己实现
date: 2020-09-10 17:57:17
tags:
	- 蓝牙

---

1

为了让自己深入理解btstack和蓝牙协议栈。自己写一遍btstack。

```
teddy@thinkpad:~/work/mybtstack$ tree
.
├── help.txt
├── Makefile
├── mylog.h
├── platform
│   └── posix
├── port
│   └── libusb
│       ├── btstack_config.h
│       └── main.c
├── README.md
└── src
    ├── btstatck_run_loop.c
    └── btstatck_run_loop.h
```

先建立一个这个最小的目录结构。

main.c的直接拷贝过来。libusb的细节不是我现在关注的重点。

btstack_config.h，这个里面只是宏定义，不依赖其他的文件。所以可以先写。

而且它是被几乎所有其他文件依赖的。

然后是btstack_defines.h，它依赖了btstack_linked_list.h。

所以先写btstack_linked_list.h

这个是一个单向链表。

btstack_defines.h 先只写几个typedef。后面的宏定义太多了。不管先。

btstack_event.h 

这个注释里写了：

```
Don't edit - generated by tool/btstack_event_generator.py
```

这个是靠脚本生成的。

