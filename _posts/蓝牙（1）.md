---
title: 蓝牙（1）
date: 2018-11-28 09:37:28
tags:
	- 蓝牙
typora-root-url: ..\
---



是的，现在要重新学习蓝牙。借助谷歌一点点搜索来做。



蓝牙技术规范可以分为两层：

1、核心规范。规定蓝牙必须实现的通用功能。

2、应用规范。也叫profile。可选。

结构是这样：

![](/images/蓝牙规范分层.webp)



蓝牙技术分为两种，经典蓝牙和BLE。

经典蓝牙

Basic Rate。简称BR。包括EDR和AMP两个增强技术。

Basic Rate才是最原始的蓝牙技术。这个的理论速度只能达到721.2kbps。但是要考虑到蓝牙技术诞生的时候，modem上网的速度只有56kbps。

但是时代变化太快，BR的速度很快就落伍了。怎么办？缝缝补补，推出了EDR（Enhanced Data Rate）。这个的理论速度是2.1Mbps。这种改进，还算优雅，没有什么改动就完成了。

但是WiFi的速度远高于这个，相比之下，太寒酸了。蓝牙组织就打起了WiFi的注意，借用了wifi的mac层和phy层。这个就是AMP（Alternate MAC and PHY ）。这样速度就可以达到24Mbps。

要么就使用BR/EDR，要么就用AMP，二选一。

BLE

BLE跟BR的差别特别大。基本上算两种技术了。



# ble单模和双模

ble单模就是只支持ble。

双模技术既支持ble，也支持传统蓝牙。

# 蓝牙技术的主要组织

蓝牙技术联盟，简称SIG。



使用手机来模拟外设，在安卓手机上可以运行一个软件：com-ble-peripheral-sim.apk，使用该软件可以非常方便的创建各种蓝牙外设，创建各种服务。

在实际开发中，可能使用一个手机当做中央设备。在学习中，使用一个usb蓝牙模块，将该蓝牙模块接到pc机上，使用pc机上的软件可以通过这个usb蓝牙模块去发现各种外设，连接各种外设，去修改、读写外设的值。**无论是实际开发还是学习，都需要一个sniffer。**



抓包过程涉及三个软件：

a. Windows PC：Bluetooth LE Exploer

用于控制蓝牙中央设备，发起连接外设、操作外设。

从Microsoft Store安装即可。

b. Windows PC：Wireshark

抓包软件，通过Sniffer硬件来抓包。

安装、使用方法参考文档《BLE_sniffer抓包工具使用手册》

c. Android手机：com-ble-peripheral-sim.apk

BLE外设模拟软件，可以很方便地新建BLE服务。



# 蓝牙编码

总听到不少人说蓝牙音质不好、音质不行、巴拉巴拉的……，蓝牙技术通过二十多年的发展，版本迭代从1.0～5.1，其实蓝牙早已不是之前那个蓝牙了。

所以，如果你觉得蓝牙音质不好，可能有两个原因，一是设备太过于陈旧而不支持很多新的协议，二就是你是否选择了“正确的”蓝牙音频编码。

## SBC

在所有的蓝牙音频编码中，SBC音频编码是最古老的，已经有着20年的历史了，它是A2DP（Advanced Audio Distribution Profile）蓝牙音频传输协议中强制规定的一种蓝牙音频编码，因此，**所有的立体声蓝牙设备、所有的蓝牙音频芯片都会支持这个编码**。

由于无线传输的带宽有限，SBC在对每个子频段进行编码时，进行了有损处理，以达到数据压缩的目的——即经过SBC编解码以后，PCM数据发生了变化。

我们以MP3文件为例，转码过程为 MP3→PCM→SBC→PCM，因为每次转码都会损失细节，所以，**同样规格的MP3文件在无线环境下要比有线环境损失更多细节，听感也就不如有线传输了。**

人们在蓝牙音频发展的初期对其音质不看好，主要原因也是因为SBC技术自身的瓶颈所导致的。

兼容性：**通用并最基本的音频解码，几乎支持所有的蓝牙音频设备。**

音质表现：**非常一般，SBC支持44kHz/16bit音频，最高码率仅为328kbps。**

综合评价：**随着信号处理技术、半导体技术的进步，人们对SBC压缩效率低、延迟大、音质不好的抱怨越来越多，所以SBC并不是目前我们希望你去体验的蓝牙音频编码。**





https://zhuanlan.zhihu.com/p/150523748

1、蓝牙技术基础知识学习

https://www.jianshu.com/p/78460132a563

2、蓝牙模块——基础知识介绍

https://blog.csdn.net/wwt18811707971/article/details/77833602