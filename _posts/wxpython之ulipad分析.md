---
title: wxpython之ulipad分析
date: 2022-12-30 17:12:30
tags:
	- python
---

--

https://github.com/limodou/ulipad

ulipad是一个wxpython写的编辑器。

虽然没有继续维护了。但是作为一个具有实用价值的编辑器，是我目前找到最复杂的wxpython应用。所以还是有研究价值的。

代码目录下有比较详细的文档，说明了设计的思路。

可以学习一下。



UliPad的设计核心就是，如何构造一 种灵活的架构，使得新功能的增加更为方便和易于维护。

这样，UliPad的设计思想就是充分利用Python语言的动态特性，构造易于扩充而又灵活的软件体系。

具体的实现技术 就是全部采用Mixin和Plugin的设计与开发方法，

更为通俗地说法就是分布式类编程技术，

或狭义地理解为插件编程 (但分布式类编程与插件编程是不同的，分布类编程包括Mixin和Plugin，而插件编程一般只包括Plugin，因此插件编程 的功能扩展是有局限的)。

有时为了简单，我会叫分布类编程为Mixin，具体到技术细节时，会细分Mixin和Plugin。

比如，软件刚开始还是一个雏形，可能只有少数的功能。因此，会有一些实现了基础功能的类。当这些基础功能稳定，同 时有新的需求时，这时需要对这些类进行扩展。扩展基本分为两种：

> 1. 新的方法、属性的实现
> 2. 增加对新方法、属性的调用入口

知道了扩展方式，那么在哪里去实现呢？

对于第1种扩展，我的方法是，基本不动原来的类所在的文件，而是创建一个 新的文件，在这个新文件中实现新的方法、属性。

然后通过一种机制把新的方法和属性与目标类进行融合，同时这种融 合是在运行时才实现的。

这样，一个类的功能是随着开发的进行，不停地进行扩展。

由于新的扩展并不是直接在原来的 文件中进行地修改，并且在一个文件中可以同时对多个类进行扩展，因此相对容易地知道本次扩展都做了哪些工作，对 于软件的维护非常方便。

这些扩展会通过一种机制，在软件运行时自动与目标类进行融合，不需要做额外的工作。

**对于 这种扩展，我叫它为Mixin扩展。**

对于第2种扩展，我的方法是，在原来的类中增加相应的调用接口，同时在Mixin扩展 中增加对调用接口的具体实现，从而通过调用接口将新增的功能与原类联系起来。

**对于这种扩展我叫它为Plugin扩展， 也可以叫做插件扩展。**



因此Mixin扩展的开发主要是对目标类进行功能扩展，如增加新的类方法，修改类方法，增加新的属性等。

对于Plugin 扩展主要是在目标类中需要寻找合适的调用位置，定义相应的调用接口。同时实现具体的Plugin实现代码。



这里还存在的一个要考虑的问题是，Plugin扩展要根据具体情况考虑是否需要实现。

首先，实现Plugin是因为新增的方法、 属性的使用不会自动完成，需要一个调用点。

如果你扩展的方法属合某种事件机制的调用规则，那么可以不用实现Plugin接 口，否则就要实现相应的Plugin接口。



因此Mixin与Plugin的区别就是：Mixin实现类的新方法和属性，而Plugin实现调用点的具体处理。

更简单地理解：Mixin是对未知的扩展，而 Plugin是对已知的扩展。





一个槽类就是可以允许实现Mixin的类，也叫目标类。

一个类成为槽类必须从Mixin类进行派生，需要定义一个__mixinname__的类属性，这个 属性就是用来关联Mixin和Plugin与槽类的唯一标识。

同时在槽类的构造函数__init__中需要调用self.initmixin()(它是Mixin类的一个方法) 。

这样，当创建槽类的实例时，就会使用此方法将所有与此槽类相关的Mixin和Plugin与槽类进行融合，从而生成最终的类。

此过程是对类本身， 而非实例本身，并且通过内部机制可以保证只执行一次。因此一个槽类只有在运行时，并且在创建了一个实例时才会是真正完整的。

**这一些的实现 都要感谢Python本身的动态特性。**



# 参考资料

1、

https://cloud.tencent.com/developer/article/1011117