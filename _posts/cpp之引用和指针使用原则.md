---
title: cpp之引用和指针使用原则
date: 2018-05-13 19:16:13
tags:
	- cpp

---



为什么要使用引用？

1、可以修改对象的成员。

2、传递引用比传递整个对象的效率高。



传递参数，有两种情况，一种是修改值，一种是不修改值。



不修改的情况：

1、如果是数组，只能传递指针。但是要把指针声明为const。

2、对于类对象，传递引用是标准做法。



修改的情况：

1、如果是内置数据类型，用指针。

2、如果是数组类型，用指针。

3、结构体，指针和引用都可以。

4、类，用引用。



##连续2个&号

我看到有连续2个&符号的用法，不知道具体代表了什么内涵？二级引用吗？

&&是右值引用。&是普通的左值引用。

所谓右值，就是永远不能放在=的左边。

常见的应用情况是：

例如string类内部，都有一个char *指针pstr指向实际存放字符串的内存。

对于这条语句：

```
str3 = str1.concat(str2);
```

实际是执行了2次构造函数，第一次是concat构造一个新的string对象。

第二次是赋值的时候执行了一次拷贝构造函数，把concat的临时值复制给了str3的内存。

然后concat的临时值在之后立即被销毁了。显然第二次拷贝构造很多余。

有了&&之后，可以给string增加一个参数是&&的拷贝构造函数来解决这个问题。

实现是这样：

```
string(string&& other) {
  pstr = other.pstr;
  other.pstr = nullptr;
}
```





# 参考资料

1、什么时候使用引用、什么时候使用指针

https://blog.csdn.net/hao5335156/article/details/53893714

2、c++中&和&&引用工作原理的区别？

https://zhidao.baidu.com/question/426629663273398972.html