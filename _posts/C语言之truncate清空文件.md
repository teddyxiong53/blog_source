---
title: C语言之truncate清空文件
date: 2022-12-02 14:43:25
tags:
	- C语言

---

--

清空文件这个功能，一般没有怎么使用。现在使用发现有些不符合预期的行为。

所以需要研究一下。



注意事项：

此函数并未实质性的向磁盘写入数据，

只是分配了一定的空间供当前文件使用。

当fd<length时，此时如果使用十六进制编辑工具打开该文件，你会发现文件末尾多了很多00，这就是执行这个函数后的效果。

如果发生系统复位或者装置掉电以后，该函数所产生的作用将被文件系统忽略，也就是说它所分配的空间将不能被识别，文件的大小将会是最后一次写入操作的区域大小，而非ftruncate分配的空间大小，也就是说，文件大小有可能会被改变。



原型：int ftruncate(int fildes, off_t length);
注意：

1.清空文件后，需要使用rewind或fseek将文件指针移到文件头。



参考资料

1、

https://blog.csdn.net/weixiuc/article/details/3403602

2、

https://blog.csdn.net/weixin_34200628/article/details/91832536